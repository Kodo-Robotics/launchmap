tests:
  - name: minimal_node_xml
    description: Node with just package and executable (XML)
    input: |
      <?xml version="1.0" encoding="UTF-8"?>
      <launch>
        <node pkg="my_pkg" exec="my_node"/>
      </launch>
    expected:
      nodes:
        - package: my_pkg
          executable: my_node

  - name: node_with_fields_xml
    description: Node with name, output, parameters and remapping (XML)
    input: |
      <?xml version="1.0" encoding="UTF-8"?>
      <launch>
        <node pkg="demo_nodes" exec="talker" name="talker_node" output="screen">
          <param name="use_sim_time" value="$(var use_sim_time)"/>
          <param name="use_remapping" value="true"/>
          <remap from="/input" to="/robot1/input"/>
          <remap from="/output" to="/robot1/output"/>
        </node>
      </launch>
    expected:
      nodes:
        - package: demo_nodes
          executable: talker
          name: talker_node
          output: screen
          parameters:
              use_sim_time: "${LaunchConfiguration:use_sim_time}"
              use_remapping: "true"
          remappings:
            - ['/input', '/robot1/input']
            - ['/output', '/robot1/output']
  
  - name: multiple_nodes_xml
    description: Two nodes declared directly under <launch>
    input: |
      <?xml version="1.0" encoding="UTF-8"?>
      <launch>
        <node pkg="demo" exec="a"/>
        <node pkg="demo" exec="b"/>
      </launch>
    expected:
      nodes:
        - package: demo
          executable: a
        - package: demo
          executable: b

  - name: node_with_environment_variable_xml
    description: Node with Environment Variables
    input: |
      <?xml version="1.0"?>
      <launch>
        <node pkg="demo_pkg" exec="talker">
          <env name="RCUTILS_LOG_LEVEL" value="debug"/>
          <env name="CUSTOM" value="42"/>
        </node>
      </launch>
    expected:
      nodes:
        - package: demo_pkg
          executable: talker
          env:
            RCUTILS_LOG_LEVEL: debug
            CUSTOM: "42"
